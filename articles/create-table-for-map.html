<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Create table for map • presentresults</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create table for map">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">presentresults</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/add-label-to-results-table.html">Add labels to results table</a></li>
    <li><a class="dropdown-item" href="../articles/create-table-for-map.html">Create table for map</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create table for map</h1>
            
      

      <div class="d-none name"><code>create-table-for-map.Rmd</code></div>
    </div>

    
    
<p>This vignette will show an example how to create a table for the MSNA
Indicator Maps 1.2 tool.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://impact-initiatives.github.io/presentresults/">presentresults</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">results_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>analysis_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"msni_in_need"</span>, <span class="st">"comp_health_in_need"</span>, <span class="st">"comp_prot_in_need"</span>, <span class="st">"comp_edu_in_need"</span>, <span class="st">"comp_foodsec_in_need"</span>,<span class="st">"comp_wash_in_need"</span>,        <span class="st">"comp_snfi_in_need"</span><span class="op">)</span>,</span>
<span>                             analysis_var_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                             group_var <span class="op">=</span> <span class="st">"admin1"</span>,</span>
<span>                             group_var_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PCODE1"</span>, <span class="st">"PCODE2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12344</span><span class="op">)</span></span>
<span><span class="va">results_table</span><span class="op">$</span><span class="va">stat</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">results_table</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The results table shown below present the results in a long format
for 7 indicators (<strong>msni_in_need</strong>,
<strong>comp_health_in_need</strong>,
<strong>comp_prot_in_need</strong>, <strong>comp_edu_in_need</strong>,
<strong>comp_foodsec_in_need</strong>,<strong>comp_wash_in_need</strong>,
<strong>comp_snfi_in_need</strong>) for the admin1
(<strong>PCODE1</strong> and <strong>PCODE2</strong>). <code>stat</code>
column represent the percentages.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;           analysis_var analysis_var_value group_var group_var_value       stat</span></span>
<span><span class="co">#&gt; 1         msni_in_need                  1    admin1          PCODE1 0.06471086</span></span>
<span><span class="co">#&gt; 2  comp_health_in_need                  1    admin1          PCODE1 0.93059035</span></span>
<span><span class="co">#&gt; 3    comp_prot_in_need                  1    admin1          PCODE1 0.05543592</span></span>
<span><span class="co">#&gt; 4     comp_edu_in_need                  1    admin1          PCODE1 0.06287199</span></span>
<span><span class="co">#&gt; 5 comp_foodsec_in_need                  1    admin1          PCODE1 0.18820633</span></span>
<span><span class="co">#&gt; 6    comp_wash_in_need                  1    admin1          PCODE1 0.74359703</span></span></code></pre></div>
<p>Maps can only show one information per admin level. First thing is to
filter the results table for the information to get the information to
be map. In the example, the analysis variable value can be 1 or 0, where
1 means “in need”, and 0 means “not in need”. The map will show the
percentages of household in needs, the results will be filtered for 1.
Then the function <code>create_table_for_map</code> can be used.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_table_filtered</span> <span class="op">&lt;-</span> <span class="va">results_table</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">analysis_var_value</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_table_recoded_5_classes</span> <span class="op">&lt;-</span> <span class="va">results_table_filtered</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/create_table_for_map.html">create_table_for_map</a></span><span class="op">(</span>number_classes <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_table_recoded_5_classes</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 8</span></span></span>
<span><span class="co">#&gt;   group_var_value msni_in_need comp_health_in_need comp_prot_in_need</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PCODE1          2            5                   2                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PCODE2          3            2                   3                </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: comp_edu_in_need &lt;chr&gt;, comp_foodsec_in_need &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   comp_wash_in_need &lt;chr&gt;, comp_snfi_in_need &lt;chr&gt;</span></span></span></code></pre></div>
<p>If you want to use 6 classes, set the argument
<code>number_classes</code> to 6.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_table_filtered</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/create_table_for_map.html">create_table_for_map</a></span><span class="op">(</span>number_classes <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 8</span></span></span>
<span><span class="co">#&gt;   group_var_value msni_in_need comp_health_in_need comp_prot_in_need</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PCODE1          2            6                   2                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PCODE2          3            2                   3                </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: comp_edu_in_need &lt;chr&gt;, comp_foodsec_in_need &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   comp_wash_in_need &lt;chr&gt;, comp_snfi_in_need &lt;chr&gt;</span></span></span></code></pre></div>
<p>There can be 5 or 6 classes as follow:</p>
<div class="section level3">
<h3 id="classes">5 classes<a class="anchor" aria-label="anchor" href="#classes"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Class</th>
<th>Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>&lt;= 25%</td>
</tr>
<tr class="odd">
<td>3</td>
<td>&lt;= 50%</td>
</tr>
<tr class="even">
<td>4</td>
<td>&lt;= 75%</td>
</tr>
<tr class="odd">
<td>5</td>
<td>&lt;= 100%</td>
</tr>
<tr class="even">
<td>empty</td>
<td>Anything else</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="classes-1">6 classes<a class="anchor" aria-label="anchor" href="#classes-1"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Class</th>
<th>Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>&lt;= 20%</td>
</tr>
<tr class="odd">
<td>3</td>
<td>&lt;= 40%</td>
</tr>
<tr class="even">
<td>4</td>
<td>&lt;= 60%</td>
</tr>
<tr class="odd">
<td>5</td>
<td>&lt;= 80%</td>
</tr>
<tr class="even">
<td>6</td>
<td>&lt;= 100%</td>
</tr>
<tr class="odd">
<td>empty</td>
<td>Anything else</td>
</tr>
</tbody>
</table>
<p>If you have more than one value per indicator and admin level, you
should get a warning from tidyr. You can use it to explore where the
problem lies.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_table</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/create_table_for_map.html">create_table_for_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Values from `stat_recoded` are not uniquely identified; output will contain</span></span>
<span><span class="co">#&gt; list-cols.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Use `values_fn = list` to suppress this warning.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Use `values_fn = {summary_fun}` to summarise duplicates.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Use the following dplyr code to identify duplicates.</span></span>
<span><span class="co">#&gt;   {data} |&gt;</span></span>
<span><span class="co">#&gt;   dplyr::summarise(n = dplyr::n(), .by = c(group_var_value, analysis_var)) |&gt;</span></span>
<span><span class="co">#&gt;   dplyr::filter(n &gt; 1L)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 8</span></span></span>
<span><span class="co">#&gt;   group_var_value msni_in_need comp_health_in_need comp_prot_in_need</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PCODE1          <span style="color: #949494;">&lt;chr [2]&gt;</span>    <span style="color: #949494;">&lt;chr [2]&gt;</span>           <span style="color: #949494;">&lt;chr [2]&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PCODE2          <span style="color: #949494;">&lt;chr [2]&gt;</span>    <span style="color: #949494;">&lt;chr [2]&gt;</span>           <span style="color: #949494;">&lt;chr [2]&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: comp_edu_in_need &lt;list&gt;, comp_foodsec_in_need &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   comp_wash_in_need &lt;list&gt;, comp_snfi_in_need &lt;list&gt;</span></span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mehedi Khan, Yann Say.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
